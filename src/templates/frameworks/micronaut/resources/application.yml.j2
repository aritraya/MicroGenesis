# Server configuration
micronaut:
  application:
    name: {{ project_name }}
  server:
    port: 8080
  
  {% if features and 'security' in features %}
  # Security configuration
  security:
    enabled: true
    endpoints:
      login:
        enabled: true
      logout:
        enabled: true
  {% endif %}

{% if database.name %}
# Database configuration
datasources:
  default:
    {% if database.name == "postgresql" or database.name == "postgres" %}
    url: jdbc:postgresql://{{ database.host | default('localhost') }}:{{ database.port | default('5432') }}/{{ database.name | default(project_name) }}
    username: {{ database.username | default('postgres') }}
    password: {{ database.password | default('postgres') }}
    driverClassName: org.postgresql.Driver
    {% elif database.name == "mysql" %}
    url: jdbc:mysql://{{ database.host | default('localhost') }}:{{ database.port | default('3306') }}/{{ database.name | default(project_name) }}
    username: {{ database.username | default('root') }}
    password: {{ database.password | default('root') }}
    driverClassName: com.mysql.cj.jdbc.Driver
    {% elif database.name == "h2" %}
    url: jdbc:h2:mem:{{ project_name }}
    username: sa
    password: password
    driverClassName: org.h2.Driver
    {% endif %}

{% if database.name != "mongodb" %}
# JPA configuration
jpa:
  default:
    entity-scan:
      packages: {{ base_package }}.entity
    properties:
      hibernate:
        hbm2ddl:
          auto: update
        show_sql: true
{% endif %}

{% if database.name == "mongodb" %}
# MongoDB configuration
mongodb:
  uri: mongodb://{% if database.username and database.password %}{{ database.username }}:{{ database.password }}@{% endif %}{{ database.host | default('localhost') }}:{{ database.port | default('27017') }}/{{ database.name | default(project_name) }}{% if database.username and database.password %}?authSource=admin{% endif %}
{% endif %}
{% endif %}

{% if features and 'logging' in features %}
# Logging configuration
logger:
  levels:
    {{ base_package }}: DEBUG
    io.micronaut: INFO
    {% if database.name != "mongodb" %}
    org.hibernate.SQL: DEBUG
    {% endif %}
{% endif %}

# Application-specific configuration
{{ project_name | lower }}:
  app:
    name: {{ project_name }}
    description: {{ description | default('Generated by MicroGenesis') }}
    version: 1.0.0
