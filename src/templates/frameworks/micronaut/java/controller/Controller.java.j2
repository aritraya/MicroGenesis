package {{ base_package }}.controller;

import {{ base_package }}.entity.SampleEntity;
import {{ base_package }}.service.SampleEntityService;
{% if dto_pattern is defined and dto_pattern %}
import {{ base_package }}.dto.SampleEntityDto;
import {{ base_package }}.mapper.SampleEntityMapper;
{% endif %}
import io.micronaut.http.HttpResponse;
import io.micronaut.http.HttpStatus;
import io.micronaut.http.annotation.*;
import io.micronaut.validation.Validated;

import java.util.List;
import java.util.UUID;
{% if dto_pattern is defined and dto_pattern %}
import java.util.stream.Collectors;
{% endif %}

/**
 * REST controller for SampleEntity operations.
 * <p>
 * Generated by MicroGenesis scaffolding tool.
 * </p>
 */
@Controller("/api/sample-entities")
@Validated
public class SampleEntityController {

    private final SampleEntityService service;
    
    {% if dto_pattern is defined and dto_pattern %}
    private final SampleEntityMapper mapper;
    
    public SampleEntityController(SampleEntityService service, SampleEntityMapper mapper) {
        this.service = service;
        this.mapper = mapper;
    }
    {% else %}
    public SampleEntityController(SampleEntityService service) {
        this.service = service;
    }
    {% endif %}

    /**
     * Get all sample entities.
     *
     * @return list of all entities
     */
    @Get
    {% if dto_pattern is defined and dto_pattern %}
    public HttpResponse<List<SampleEntityDto>> findAll() {
        List<SampleEntity> entities = service.findAll();
        List<SampleEntityDto> dtos = entities.stream()
                .map(mapper::toDto)
                .collect(Collectors.toList());
        return HttpResponse.ok(dtos);
    }
    {% else %}
    public HttpResponse<List<SampleEntity>> findAll() {
        return HttpResponse.ok(service.findAll());
    }
    {% endif %}

    /**
     * Get a sample entity by ID.
     *
     * @param id entity ID
     * @return the entity if found, or 404 Not Found
     */
    @Get("/{id}")
    {% if dto_pattern is defined and dto_pattern %}
    public HttpResponse<SampleEntityDto> findById(@PathVariable UUID id) {
        return service.findById(id)
                .map(mapper::toDto)
                .map(HttpResponse::ok)
                .orElse(HttpResponse.notFound());
    }
    {% else %}
    public HttpResponse<SampleEntity> findById(@PathVariable UUID id) {
        return service.findById(id)
                .map(HttpResponse::ok)
                .orElse(HttpResponse.notFound());
    }
    {% endif %}

    /**
     * Create a new sample entity.
     *
     * @param entityData entity data to create
     * @return the created entity
     */
    @Post
    @Status(HttpStatus.CREATED)
    {% if dto_pattern is defined and dto_pattern %}
    public HttpResponse<SampleEntityDto> create(@Body SampleEntityDto entityData) {
        SampleEntity entity = mapper.toEntity(entityData);
        SampleEntity createdEntity = service.create(entity);
        return HttpResponse
                .created(mapper.toDto(createdEntity));
    }
    {% else %}
    public HttpResponse<SampleEntity> create(@Body SampleEntity entity) {
        SampleEntity createdEntity = service.create(entity);
        return HttpResponse.created(createdEntity);
    }
    {% endif %}

    /**
     * Update an existing sample entity.
     *
     * @param id entity ID
     * @param entityData updated entity data
     * @return the updated entity if found, or 404 Not Found
     */
    @Put("/{id}")
    {% if dto_pattern is defined and dto_pattern %}
    public HttpResponse<SampleEntityDto> update(@PathVariable UUID id, @Body SampleEntityDto entityData) {
        SampleEntity entity = mapper.toEntity(entityData);
        return service.update(id, entity)
                .map(mapper::toDto)
                .map(HttpResponse::ok)
                .orElse(HttpResponse.notFound());
    }
    {% else %}
    public HttpResponse<SampleEntity> update(@PathVariable UUID id, @Body SampleEntity entity) {
        return service.update(id, entity)
                .map(HttpResponse::ok)
                .orElse(HttpResponse.notFound());
    }
    {% endif %}

    /**
     * Delete a sample entity.
     *
     * @param id entity ID
     * @return 204 No Content if deleted, or 404 Not Found
     */
    @Delete("/{id}")
    public HttpResponse<Void> delete(@PathVariable UUID id) {
        boolean deleted = service.deleteById(id);
        
        if (deleted) {
            return HttpResponse.noContent();
        } else {
            return HttpResponse.notFound();
        }
    }
}
